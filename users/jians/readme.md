swapper logic taken from callum
